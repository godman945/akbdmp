<!DOCTYPE>
<html>
<head>
<script>
	console.clear();
	console.log("=============================");
	var height = window.parent.innerHeight;
	var width = window.parent.innerWidth;
	document.addEventListener('DOMContentLoaded', function () {
		
		var iframeArray = window.parent.document.getElementsByTagName("iframe");
		
		for(var i = 0; i < iframeArray.length; i++){
			//console.log(iframeArray[i]);
			var video =  iframeArray[i].contentWindow.document.querySelector(".home-banner");
			if(video == null){
				break;
			}
			video.pause();
		}
	
		window.parent.addEventListener('scroll', function() {
			for(var i = 0; i< iframeArray.length; i++){
				//console.log("高度:"+iframeArray[i].getBoundingClientRect().top);
				//console.log("左邊:"+iframeArray[i].getBoundingClientRect().left);
				//console.log("底部:"+iframeArray[i].getBoundingClientRect().bottom);
				var inVpFull = isElementInViewport(iframeArray[i].parentElement);
				var inVpPartial = isElementPartiallyInViewport(iframeArray[i].parentElement);
				var video =  iframeArray[i].contentWindow.document.querySelector(".home-banner");
				
				/*	
				if(!inVpFull){
					video.pause();
				}else{
					video.play();
				}
				*/		
				
				if(!inVpPartial){
					video.pause();
				}else{
					video.play();
				}
					
				//console.log("Fully in viewport: " + inVpFull);
			   // console.log("*******");
			}
	    });
	}, false);
	
	function isElementInViewport (element) {
        //special bonus for those using jQuery
        if (typeof jQuery !== 'undefined' && element instanceof jQuery) element = element[0];
        var rect = element.getBoundingClientRect();
        if(element.getBoundingClientRect().top < 0 ){
       	 return false;
        }else{
       	 return true;
        }
    }
	 
	 function isElementPartiallyInViewport(element)  {
		 if (typeof jQuery !== 'undefined' && element instanceof jQuery) element = element[0];
        var rect = element.getBoundingClientRect();
        if(element.getBoundingClientRect().bottom < 100 || element.getBoundingClientRect().bottom  > height +100){
       	 return false;
        }else{
       	 return true;
        }
    }
</script>	

	
</head>
<body>

<div id="video-over">
<video class="home-banner" id="video" controls autoplay loop>
	<source src="http://dmpstg.mypchome.com.tw/AkbDmp/Dovey.mp4" ></source>
	<!--<source src="http://vstreamdev.mypchome.com.tw/20170119001/20170119001-0240p-0300k-vp8.webm" ></source> --> 
</video>
</div>
<script>


</script>
</body>
</html>